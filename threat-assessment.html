<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Threat Assessment — CommsBlack Mobile</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="script.js"></script>
  <style>
    /* ---- HARD FIXES (scoped to this page only) ---- */
    body.page-threat .hero,
    body.page-threat .hero::before,
    body.page-threat .hero::after { display:none !important; }
    body.page-threat { background-image:none !important; }
    body.page-threat main.container { max-width: 1000px; }

    /* Header layout fallback so nav never stacks as bullets */
    body.page-threat header .container { display:flex; align-items:center; justify-content:space-between; gap: 16px; }
    body.page-threat header nav ul { list-style:none; display:flex; gap:18px; padding:0; margin:0; align-items:center; }
    body.page-threat header nav ul li { margin:0; }
    body.page-threat header a.logo { display:flex; align-items:center; gap:10px; text-decoration:none; }
    body.page-threat header a.logo img { height:24px; width:auto; }

    /* Active link hint (safe fallback if site CSS misses it) */
    body.page-threat header nav a.active { text-decoration: underline; }

    /* Tiles + progress (scoped) */
    .qa-section { margin: 1.25rem 0 1.1rem; }
    .qa-section h2 { margin: .25rem 0 .6rem; font-size: 1.05rem; }
    .tiles { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:12px; }
    .tile { position:relative; display:flex; align-items:center; justify-content:center; padding:12px; border-radius:12px; line-height:1.2; cursor:pointer; user-select:none; border:1px solid rgba(255,255,255,.25); transition: transform .06s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease; text-align:center; }
    .tile input { position:absolute; inset:0; opacity:0; pointer-events:none; }
    .tile:hover { border-color: color-mix(in oklab, currentColor 40%, rgba(255,255,255,.25)); }
    .tile.active { border-color: currentColor; background: color-mix(in oklab, currentColor 10%, transparent); box-shadow: 0 0 0 3px color-mix(in oklab, currentColor 25%, transparent); transform: translateY(-1px); }

    .progress-shell { position: sticky; top: 0; z-index: 40; backdrop-filter: blur(4px); }
    .progress-bar-bg { height: 6px; width: 100%; background: rgba(255,255,255,.12); }
    .progress-bar-fill { height: 6px; width: 0%; background: currentColor; transition: width .25s ease; }
    .progress-meta { font-size: .9rem; margin-top: .35rem; opacity: .85; }
    @media (max-width: 520px){ .tiles{ grid-template-columns:1fr; } }
  </style>
</head>
<body class="page-threat">

  <header>
    <div class="container">
      <a href="index.html" class="logo">
        <img src="assets/logo.png" alt="CommsBlack Mobile" />
        CommsBlack Mobile
      </a>

      <nav>
        <ul>
          <li><a href="index.html">Mission</a></li>
          <li><a class="active" href="threat-assessment.html">Threat Assessment</a></li>
          <li><a href="products.html">Products</a></li>
          <li><a href="academy.html">Academy</a></li>
          <li><a href="faqs.html">FAQ's</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>

      <button class="theme-toggle" id="themeToggle">
        <span class="icon-sun"></span>
      </button>
    </div>
  </header>

  <div class="container progress-shell">
    <div class="progress-bar-bg">
      <div id="progressFill" class="progress-bar-fill"></div>
    </div>
    <div id="progressText" class="progress-meta">0% complete</div>
  </div>

  <main class="container">
    <h1>Threat Assessment</h1>
    <p>Answer the following to get a brief analysis of your adversary posture and recommended Communication Kit / OPSEC posture.</p>

    <form id="threatForm" novalidate>
      <!-- Device use -->
      <section class="qa-section" data-q>
        <h2>Device use</h2>
        <div class="tiles">
          <label class="tile"><input type="radio" name="device_use" value="personal" required>Personal use</label>
          <label class="tile"><input type="radio" name="device_use" value="professional">Professional use</label>
          <label class="tile"><input type="radio" name="device_use" value="highrisk">High risk work</label>
        </div>
      </section>

      <!-- Adversary class -->
      <section class="qa-section" data-q>
        <h2>Adversary class (opportunist / targeted / state)</h2>
        <div class="tiles">
          <label class="tile"><input type="radio" name="adversary" value="bigtech" required>Big‑tech / Data brokers</label>
          <label class="tile"><input type="radio" name="adversary" value="stalker">Stalker / Private Investigator</label>
          <label class="tile"><input type="radio" name="adversary" value="scammers">Scammers / Hackers</label>
          <label class="tile"><input type="radio" name="adversary" value="criminal">Criminal / Organised crime</label>
          <label class="tile"><input type="radio" name="adversary" value="state">Law enforcement / Nation‑state / Military</label>
        </div>
      </section>

      <!-- Assets -->
      <section class="qa-section" data-q>
        <h2>Assets requiring protection?</h2>
        <div class="tiles">
          <label class="tile"><input type="checkbox" name="assets" value="identity">Identity</label>
          <label class="tile"><input type="checkbox" name="assets" value="location">Location</label>
          <label class="tile"><input type="checkbox" name="assets" value="communications">Communications</label>
          <label class="tile"><input type="checkbox" name="assets" value="content">Content (photos/docs)</label>
          <label class="tile"><input type="checkbox" name="assets" value="metadata">Metadata</label>
          <label class="tile"><input type="checkbox" name="assets" value="contacts">Contacts / Relationships</label>
        </div>
      </section>

      <!-- Consequences -->
      <section class="qa-section" data-q>
        <h2>Consequence if assets exploited</h2>
        <div class="tiles">
          <label class="tile"><input type="checkbox" name="consequences" value="inconvenience">Inconvenience</label>
          <label class="tile"><input type="checkbox" name="consequences" value="reputation">Reputational harm</label>
          <label class="tile"><input type="checkbox" name="consequences" value="employment">Employment loss</label>
          <label class="tile"><input type="checkbox" name="consequences" value="financial">Financial loss</label>
          <label class="tile"><input type="checkbox" name="consequences" value="physical">Physical harm</label>
          <label class="tile"><input type="checkbox" name="consequences" value="imprisonment">Imprisonment</label>
          <label class="tile"><input type="checkbox" name="consequences" value="death">Death</label>
        </div>
      </section>

      <!-- Targeting -->
      <section class="qa-section" data-q>
        <h2>Known targeting now?</h2>
        <div class="tiles">
          <label class="tile"><input type="radio" name="targeting" value="yes" required>Yes</label>
          <label class="tile"><input type="radio" name="targeting" value="no">No</label>
          <label class="tile"><input type="radio" name="targeting" value="unsure">Unsure</label>
        </div>
      </section>

      <!-- Capability -->
      <section class="qa-section" data-q>
        <h2>Technical capability</h2>
        <div class="tiles">
          <label class="tile"><input type="radio" name="tech" value="basic" required>Basic</label>
          <label class="tile"><input type="radio" name="tech" value="intermediate">Intermediate</label>
          <label class="tile"><input type="radio" name="tech" value="advanced">Advanced</label>
        </div>
      </section>

      <!-- Internet -->
      <section class="qa-section" data-q>
        <h2>Internet connection</h2>
        <div class="tiles">
          <label class="tile"><input type="radio" name="internet" value="public" required>Public Wi‑Fi</label>
          <label class="tile"><input type="radio" name="internet" value="personalwifi">Personal Wi‑Fi</label>
          <label class="tile"><input type="radio" name="internet" value="personalSIM">Personal SIM in my name</label>
          <label class="tile"><input type="radio" name="internet" value="anonSIM">Anonymous SIM</label>
        </div>
      </section>

      <!-- OPSEC -->
      <section class="qa-section" data-q>
        <h2>OPSEC / COMMSEC posture</h2>
        <div class="tiles">
          <label class="tile"><input type="radio" name="opsec" value="disciplined" required>Disciplined</label>
          <label class="tile"><input type="radio" name="opsec" value="basic">Basic understanding</label>
          <label class="tile"><input type="radio" name="opsec" value="unsure">Unsure / Willing to learn</label>
        </div>
      </section>

      <!-- Budget -->
      <section class="qa-section" data-q>
        <h2>Budget sense</h2>
        <div class="tiles">
          <label class="tile"><input type="radio" name="budget" value="conservative" required>Conservative</label>
          <label class="tile"><input type="radio" name="budget" value="balanced">Balanced</label>
          <label class="tile"><input type="radio" name="budget" value="priority">Priority (security first)</label>
        </div>
      </section>

      <p><button class="btn" type="submit">Get my assessment</button></p>
    </form>

    <div id="result" style="display:none;"></div>
  </main>

  <footer>
    <p>© 2025 CommsBlack Mobile. All rights reserved.</p>
  </footer>

  <script>
    // Tile behaviour + sticky progress + scoring
    document.addEventListener('click', function(e){
      const label = e.target.closest('.tile');
      if (!label) return;
      const input = label.querySelector('input');
      const group = label.parentElement;
      if (input.type === 'checkbox') {
        label.classList.toggle('active');
        input.checked = label.classList.contains('active');
      } else {
        group.querySelectorAll('.tile').forEach(t => { t.classList.remove('active'); const i=t.querySelector('input'); if(i) i.checked=false; });
        label.classList.add('active');
        input.checked = true;
      }
      updateProgress();
    }, false);

    function getAnsweredCount(){
      const sections = Array.from(document.querySelectorAll('section[data-q]'));
      let answered = 0;
      sections.forEach(sec => {
        const inputs = sec.querySelectorAll('input');
        const anyChecked = Array.from(inputs).some(i=>i.checked);
        if(anyChecked) answered++;
      });
      return {answered, total: sections.length};
    }

    function updateProgress(){
      const {answered, total} = getAnsweredCount();
      const pct = Math.round((answered/total)*100);
      const fill = document.getElementById('progressFill');
      const text = document.getElementById('progressText');
      if(fill) fill.style.width = pct + '%';
      if(text) text.textContent = pct + '% complete';
    }

    document.addEventListener('DOMContentLoaded', function(){
      updateProgress();
      const form = document.getElementById('threatForm');
      form.addEventListener('submit', function(e){
        e.preventDefault();
        const f = e.target;
        const data = {
          device_use: f.device_use.value,
          adversary: f.adversary.value,
          assets: Array.from(f.querySelectorAll("input[name='assets']:checked")).map(i=>i.value),
          consequences: Array.from(f.querySelectorAll("input[name='consequences']:checked")).map(i=>i.value),
          targeting: f.targeting.value,
          tech: f.tech.value,
          internet: f.internet.value,
          opsec: f.opsec.value,
          budget: f.budget.value
        };
        let score = 0;
        if(data.device_use==='highrisk') score += 3;
        if(data.adversary==='state') score += 4;
        if(['stalker','criminal','scammers'].includes(data.adversary)) score += 2;
        score += data.assets.length;
        if(data.consequences.includes('death') || data.consequences.includes('physical')) score += 3;
        if(data.targeting==='yes') score += 3;
        if(data.tech==='advanced') score += 2;
        if(data.internet==='public') score += 2;
        if(data.opsec==='disciplined') score -= 2;
        if(data.budget==='priority') score += 1;

        let posture = '';
        if(score <= 3) posture = 'Low — Opportunistic adversary posture';
        else if(score <= 7) posture = 'Moderate — Targeted adversary posture';
        else posture = 'High — Advanced / Nation-state level posture likely';

        let kit = [];
        if(score <= 3) {
          kit.push('Maintain strong unique passwords, 2FA, keep devices updated.');
          kit.push('Use encrypted messaging for sensitive comms (Signal).');
        } else if(score <=7) {
          kit.push('Harden device: full-disk encryption, secure backups, separate work/personal profiles.');
          kit.push('Use privacy-preserving comms, dedicated secure SIM or burner where possible.');
          kit.push('Limit metadata leaks: remove EXIF, use ephemeral accounts where feasible.');
        } else {
          kit.push('Operationalize: air-gapped options for highest-risk assets, professional security consultation.');
          kit.push('Use verified secure devices, multi-layered comms security, OPSEC training for contacts.');
          kit.push('Consider legal protections and crisis plans for physical safety.');
        }
        if(data.adversary==='bigtech') kit.push('Reduce data broker exposure: audit permissions, minimise third-party accounts.');
        if(data.adversary==='stalker') kit.push('Review physical security, home privacy, and consider changing routines.');
        if(data.assets.includes('location')) kit.push('Disable location sharing and strip geodata from content before sharing.');
        if(data.internet==='anonSIM') kit.push('Anonymous SIMs help, but pair with secure device configuration and postpaid separation.');

        const result = document.getElementById('result');
        let html = '<h2>Your assessment</h2>';
        html += '<p><strong>Score:</strong> ' + score + ' — <em>' + posture + '</em></p>';
        html += '<h3>Recommended Communication Kit / OPSEC posture</h3><ul>';
        kit.forEach(i=> html += '<li>' + i + '</li>');
        html += '</ul>';
        html += '<p><em>This is a brief automated assessment — for high-risk situations seek professional security advice.</em></p>';
        result.innerHTML = html;
        result.style.display = 'block';
        result.scrollIntoView({behavior:'smooth'});
      });
    });
  </script>

</body>
</html>
